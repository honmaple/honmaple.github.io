$(document).ready(function(){$("pre").css("max-height",$(window).height()/1.5);var s=$(".back-to-top"),e=$(".entry-navbar"),t=document.querySelectorAll(".entry-article-title"),n=window.pageYOffset;$(window).on("scroll",function(){var o,a,c,l,d,r=e.height(),i=window.pageYOffset;if(e.hasClass("entry-navbar-fixed")?i<n&&i<=10&&e.removeClass("entry-navbar-fixed"):i>n&&i>=r&&document.body.scrollHeight-document.body.offsetHeight-r>10&&e.addClass("entry-navbar-fixed"),window.innerWidth>=1280)if(o=document.getElementById("navbar-title"),i>r){for(a=t.length-1;a>=0;a--)if(i>t[a].offsetTop-t[a].offsetHeight){o||(o=document.createElement("li"),o.id="navbar-title",$(".entry-navbar-menu").prepend(o)),o.innerHTML=`<a>${t[a].innerText}</a>`;break}}else o&&o.remove();n=window.pageYOffset,s.toggleClass("on",window.pageYOffset>=120),$(".scrollbar").length&&(d=$(window).scrollTop(),c=$(window).height(),l=$(document).height(),l===c?$(".scrollbar").width("100%"):$(".scrollbar").width(d/(l-c)*100+"%"))}),s.click(function(){window.scrollTo(0,0)}),$("[data-fancybox]").fancybox({protect:!0}),$(".entry-comment a").click(function(){var e=document.createElement("script"),t=document.getElementById("comment_thread"),n=localStorage.getItem("theme")=="theme-tree"?"dark_dimmed":"light";e.type="text/javascript",e.src="https://giscus.app/client.js",e.setAttribute("data-repo","honmaple/honmaple.github.io"),e.setAttribute("data-repo-id","MDEwOlJlcG9zaXRvcnk0MTY4ODc2MQ=="),e.setAttribute("data-category","Announcements"),e.setAttribute("data-category-id","DIC_kwDOAnweuc4CVokl"),e.setAttribute("data-mapping","specific"),e.setAttribute("data-term",t.getAttribute("issue-term")),e.setAttribute("data-strict","0"),e.setAttribute("data-reactions-enabled","0"),e.setAttribute("data-emit-metadata","0"),e.setAttribute("data-input-position","bottom"),e.setAttribute("data-theme",n),e.setAttribute("data-lang","zh-CN"),e.setAttribute("crossorigin","anonymous"),t.appendChild(e),$(".entry-comment a").parent().fadeToggle(800)})});function setToc(){let e=document.querySelector("#table-of-contents");if(e){e.querySelector("h2").addEventListener("click",()=>{e.classList.toggle("in")}),document.addEventListener("scroll",t=>{let n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(n>=1280){let t=e.getBoundingClientRect();["side","in"].map(n=>e.classList.toggle(n,window.pageYOffset>t.y))}});let t=document.querySelector(".entry-article-content");if(t){const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.getAttribute("id"),n=document.querySelector(`li a[href="#${t}"]`);n.classList.toggle("active",e.isIntersecting)})});t.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]").forEach(t=>{e.observe(t)})}}}function setCollapse(){let e=document.querySelectorAll('[data-toggle="collapse"]');e.forEach((e)=>{e.dataset.target&&e.addEventListener("click",()=>{let t=document.querySelector(e.dataset.target);t&&t.classList.toggle("in")})})}document.addEventListener("DOMContentLoaded",()=>{setToc(),setCollapse()});function ISPC(){for(var s=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,e=0;e<t.length;e++)if(s.indexOf(t[e])>-1){n=!1;break}return n}function Cover(){String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return typeof e[n]!="undefined"?e[n]:t})}),$(window).width()>768&&$.ajax({type:"GET",url:"https://shici.honmaple.com/api/poems?sort=random&limit=1",dataType:"json",success:function(e){if(e.data.list.length>0){var t=e.data.list[0],n="<h3>{0}</h3>".format(t.title),s="<p>{0}</p>".format(t.author.name),o="<div>{0}</div>".format(t.content.split(`
`).map(function(e){return"<p>{0}</p>".format(e)}).join(""));$(".entry-cover > .entry-cover-right").fadeOut(500,function(){$(this).html(n+s+o).fadeIn(500)})}}});function e(){$(window).scrollTop()<$(window).height()&&!$(".entry-cover").is(":hidden")&&($(".entry-cover-left").fadeOut(300),$(".entry-cover").slideUp(600))}$(document).keydown(function(t){t.keyCode==40&&e(),t.keyCode==34&&e()}),$(window).on("wheel",function(t){t.originalEvent.deltaY>0&&e()}),$("#entry-cover").click(function(){$(".entry-cover-left").fadeOut(600),$(".entry-cover").slideUp(600)});var t={Top:-1,Y:0};$("body").on("touchstart",function(e){t={Top:$(window).scrollTop(),Y:e.originalEvent.changedTouches[0].pageY}}),$("body").on("touchend",function(n){var s=n.originalEvent.changedTouches[0].pageY-t.Y;s<0&&e()})}$(document).ready(function(){document.querySelector(".entry-cover")&&Cover()});