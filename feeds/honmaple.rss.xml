<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>honmaple's blog - honmaple</title><link>https://honmaple.me/</link><description>—— 爱情诚可贵，自由价更高.</description><lastBuildDate>Wed, 12 Sep 2018 19:01:45 +0800</lastBuildDate><item><title>ansible笔记</title><link>https://honmaple.me/articles/2018/09/ansible%E7%AC%94%E8%AE%B0.html</link><description>&lt;div id="table-of-contents"&gt;&lt;h2&gt;Table of Contents&lt;/h2&gt;&lt;div id="text-table-of-contents"&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#org-17703971"&gt;ansible动态解析inventory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-98284113"&gt;ansible自定义模块传递list变量会变成字符串&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;h2 id="org-17703971"&gt;ansible动态解析inventory&lt;/h2&gt;
&lt;p&gt;ansible调用inventory模块时总会调用一个文件或脚本来进行处理, 但我想要动态的解析inventory, 即直接传入一个字符串而不是文件, 直接调用ansible的接口来进行解析（不同格式的inventory也可以手动解析，比如yaml格式可以使用pyyaml解析，但直接使用ansible接口会更方便一些）
但ansible没有直接可供调用的接口, 不过可以直接查看ansible源码，找到相应的解析函数，封装一下即可&lt;/p&gt;

&lt;p&gt;查找源码, 根据 &lt;code&gt;InventoryManager&lt;/code&gt; 传递的&lt;b&gt;source&lt;/b&gt;变量找到&lt;code&gt;parse_sources&lt;/code&gt;这个函数&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;InventoryManager&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;parse_sources&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39; iterate over inventory sources and parse each one to populate it&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_setup_inventory_plugins&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="o"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;然后再根据&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_setup_inventory_plugins …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Tue, 04 Sep 2018 10:53:51 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-09-04:/articles/2018/09/ansible笔记.html</guid><category>linux</category><category>python</category><category>ansible</category><category>devops</category></item><item><title>花落</title><link>https://honmaple.me/articles/2018/07/%E8%8A%B1%E8%90%BD.html</link><description>

&lt;div class="org-center"&gt;
&lt;blockquote&gt;
&lt;p class="org-verse"&gt;
风落花语风落天&lt;br/&gt;花落风雨花落田
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;无意间想到的&lt;code&gt;花落系列&lt;/code&gt;。。。很好听的名字&lt;/p&gt;
&lt;/div&gt;

&lt;div class="org-center"&gt;
&lt;blockquote&gt;
&lt;p class="org-verse"&gt;
花落······雨&lt;br/&gt;&lt;br/&gt;花落······枫&lt;br/&gt;&lt;br/&gt;花落······雾&lt;br/&gt;&lt;br/&gt;花落······叶&lt;br/&gt;&lt;br/&gt;花落······雪&lt;br/&gt;&lt;br/&gt;花落······风&lt;br/&gt;&lt;br/&gt;花落······夜&lt;br/&gt;&lt;br/&gt;花落······月&lt;br/&gt;&lt;br/&gt;花落······己
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;

&lt;p&gt;。。。。&lt;/p&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Sat, 07 Jul 2018 13:56:30 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-07-07:/articles/2018/07/花落.html</guid><category>life</category><category>poem</category></item><item><title>自定义helm式的ivy</title><link>https://honmaple.me/articles/2018/06/%E8%87%AA%E5%AE%9A%E4%B9%89helm%E5%BC%8F%E7%9A%84ivy.html</link><description>&lt;div id="table-of-contents"&gt;&lt;h2&gt;Table of Contents&lt;/h2&gt;&lt;div id="text-table-of-contents"&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#org-56827192"&gt;吐嘈一: counsel-find-file&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-46223305"&gt;吐嘈二: tab 键&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-77342320"&gt;吐嘈三: 记忆多个按键&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-39855294"&gt;吐嘈四: 模糊搜索&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-77747879"&gt;吐嘈五: 候选词按使用频率排序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-60253486"&gt;吐嘈六: minibuffer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-73104572"&gt;吐嘈七: dired 中复制或重命名文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-22512558"&gt;吐嘈八: sudo edit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-31590745"&gt;吐嘈九: counsel-ag 默认不会使用已选的单词&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-16912421"&gt;总结&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;blockquote&gt;
&lt;p&gt;在 &lt;b&gt;n&lt;/b&gt; 个月前, 我曾写过 &lt;a href="https://honmaple.me/articles/2018/01/helm与ivy简单对比.html"&gt;helm与ivy简单对比&lt;/a&gt;, 并吐嘈了&lt;code&gt;ivy&lt;/code&gt;细节打磨不够，以至于我切换到&lt;code&gt;ivy&lt;/code&gt;不到几天后,
又回到了&lt;code&gt;helm&lt;/code&gt;的拥抱, 但在&lt;b&gt;n&lt;/b&gt;个月后，本着&lt;b&gt;生命不止，折腾不息&lt;/b&gt;的精神, “狠狠地”的折腾了一把 …&lt;/p&gt;&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Thu, 14 Jun 2018 15:46:18 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-06-14:/articles/2018/06/自定义helm式的ivy.html</guid><category>linux</category><category>emacs</category></item><item><title>看,那是屋檐</title><link>https://honmaple.me/articles/2018/04/%E7%9C%8B,%E9%82%A3%E6%98%AF%E5%B1%8B%E6%AA%90.html</link><description>
&lt;p&gt;&lt;a href="https://honmaple.b0.upaiyun.com/images/pic/eaves.jpg-show" data-fancybox="image"&gt;&lt;img data-src="https://honmaple.b0.upaiyun.com/images/pic/eaves.jpg-thumb" class="lazyload" /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
听说，抬起头可以看到屋檐&lt;br/&gt;可惜，外面没下雨
&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;


&lt;blockquote&gt;
&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
听说，外面在下雨&lt;br/&gt;可惜，抬起头没有屋檐
&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Tue, 24 Apr 2018 16:07:43 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-04-24:/articles/2018/04/看,那是屋檐.html</guid><category>life</category></item><item><title>落花</title><link>https://honmaple.me/articles/2018/04/%E8%90%BD%E8%8A%B1.html</link><description>
&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
落花
&lt;/p&gt;
&lt;/div&gt;


&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
落花有意随流水&lt;br/&gt;流水无心恋落花&lt;br/&gt;久在门(人)前山间坐&lt;br/&gt;静(坐)看人(世)间二月花
&lt;/p&gt;
&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Sun, 15 Apr 2018 23:02:12 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-04-15:/articles/2018/04/落花.html</guid><category>life</category><category>poem</category></item><item><title>golang笔记</title><link>https://honmaple.me/articles/2018/03/golang%E7%AC%94%E8%AE%B0.html</link><description>&lt;div id="table-of-contents"&gt;&lt;h2&gt;Table of Contents&lt;/h2&gt;&lt;div id="text-table-of-contents"&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#org-20549055"&gt;读取配置文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-76847424"&gt;判断文件是否存在&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-77850160"&gt;随机睡眠&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-22076259"&gt;字符串连接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-69045982"&gt;检查元素是否在map中&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-50435339"&gt;检查元素是否在list中&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-72355056"&gt;执行Linux命令&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-82930855"&gt;迭代文件目录&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-21403833"&gt;求两列表的差集&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-96739902"&gt;删除列表中重复的数据&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-64662301"&gt;参数校验&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#org-58598015"&gt;是否是IP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-87064949"&gt;是否是EMAIL&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;h2 id="org-20549055"&gt;读取配置文件&lt;/h2&gt;
&lt;p&gt;注: &lt;b&gt;Configuration&lt;/b&gt; 里元素(Path)必须&lt;b&gt;大写&lt;/b&gt;开头&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;encoding/json&amp;quot;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;flag&amp;quot;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;io/ioutil&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kd"&gt;type&lt;/span&gt; &lt;span class="nx"&gt;Configuration&lt;/span&gt; &lt;span class="kd"&gt;struct&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;Path&lt;/span&gt; &lt;span class="kt"&gt;string&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;VETSION&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0.1.0&amp;quot;&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="nx"&gt;config&lt;/span&gt; &lt;span class="nx"&gt;Configuration&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kd"&gt;func&lt;/span&gt; &lt;span class="nx"&gt;init&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="nx"&gt;conf_file&lt;/span&gt; &lt;span class="kt"&gt;string …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Mon, 26 Mar 2018 09:44:14 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-03-26:/articles/2018/03/golang笔记.html</guid><category>golang</category><category>coding</category></item><item><title>日上三竿与夜半三更</title><link>https://honmaple.me/articles/2018/03/%E6%97%A5%E4%B8%8A%E4%B8%89%E7%AB%BF%E4%B8%8E%E5%A4%9C%E5%8D%8A%E4%B8%89%E6%9B%B4.html</link><description>

&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
日上三竿犹在眠&lt;br/&gt;不是神仙&lt;br/&gt;胜似神仙&lt;br/&gt;&lt;br/&gt;很舒服
&lt;/p&gt;
&lt;/div&gt;


&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
夜半三更竿犹在醒&lt;br/&gt;不是鬼&lt;br/&gt;胜似鬼&lt;br/&gt;&lt;br/&gt;很难受
&lt;/p&gt;
&lt;/div&gt;


&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
日上三竿犹在醒&lt;br/&gt;不是鬼&lt;br/&gt;胜似鬼&lt;br/&gt;&lt;br/&gt;很难受
&lt;/p&gt;
&lt;/div&gt;


&lt;div class="org-center"&gt;
&lt;p class="org-verse"&gt;
夜半三更竿犹在眠&lt;br/&gt;不是神仙&lt;br/&gt;胜似神仙&lt;br/&gt;&lt;br/&gt;很舒服
&lt;/p&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Sun, 25 Mar 2018 19:30:09 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-03-25:/articles/2018/03/日上三竿与夜半三更.html</guid><category>life</category><category>poem</category></item><item><title>git笔记</title><link>https://honmaple.me/articles/2018/03/git%E7%AC%94%E8%AE%B0.html</link><description>&lt;div id="table-of-contents"&gt;&lt;h2&gt;Table of Contents&lt;/h2&gt;&lt;div id="text-table-of-contents"&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#org-50953256"&gt;git修改提交作者和邮箱&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-52016602"&gt;合并多个commit历史&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-8817443"&gt;git删除远程分支已经被删除的本地分支&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;h2 id="org-50953256"&gt;git修改提交作者和邮箱&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;提交前
&lt;p&gt;如果代码未提交,则可以&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git config  user.name &lt;span class="s2"&gt;&amp;quot;Author Name&amp;quot;&lt;/span&gt;
git config  user.email &lt;span class="s2"&gt;&amp;quot;Author Email&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;提交后
&lt;p&gt;如果代码已经提交,或者已经push到remote(只能修改最近一次提交)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git commit --amend --author&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;NewAuthor &amp;lt;NewEmail@address.com&amp;gt;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;修改全部&lt;b&gt;commit&lt;/b&gt;,需要使用脚本 &lt;a href="https://help.github.com/articles/changing-author-info/"&gt;参考github官方&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;

git filter-branch --env-filter &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="s1"&gt;OLD_EMAIL=&amp;quot;your-old-email@example.com&amp;quot;&lt;/span&gt;
&lt;span class="s1"&gt;CORRECT_NAME=&amp;quot;Your …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Thu, 01 Mar 2018 16:25:38 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-03-01:/articles/2018/03/git笔记.html</guid><category>linux</category><category>git</category></item><item><title>docker笔记</title><link>https://honmaple.me/articles/2018/02/docker%E7%AC%94%E8%AE%B0.html</link><description>&lt;div id="table-of-contents"&gt;&lt;h2&gt;Table of Contents&lt;/h2&gt;&lt;div id="text-table-of-contents"&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#org-73285490"&gt;docker删除硬盘残留的文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#org-84340943"&gt;docker构建时禁用缓存&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;h3 id="org-73285490"&gt;docker删除硬盘残留的文件&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;docker rmi ...&lt;/code&gt; 或者 &lt;code&gt;docker image rm ...&lt;/code&gt; 并不能将镜像完全删除，还会一直占用硬盘空间&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker system prune
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;该命令不会删除已存在镜像(不管是否正在运行)&lt;/p&gt;

&lt;p&gt;(硬盘一下子多个好几个G, 心情不错)&lt;/p&gt;

&lt;h3 id="org-84340943"&gt;docker构建时禁用缓存&lt;/h3&gt;
&lt;p&gt;&lt;b&gt;dockerfile&lt;/b&gt; 中有多个 RUN 或者 ADD .. 命令时, 每个 RUN 都会创建一个 image, 下一个 image 会以上一个为基础（缓存）继续构建,&lt;/p&gt;

&lt;p&gt;可以使用 &lt;code&gt;docker images -a&lt;/code&gt; 看到很多 &lt;b&gt;&amp;lt;none&amp;gt;&lt;/b&gt; 的 image&lt;/p&gt;

&lt;p&gt;不过作为一名有洁癖的coder, 这种情况不能忍&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker …&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">honmaple</dc:creator><pubDate>Fri, 23 Feb 2018 23:19:55 +0800</pubDate><guid isPermaLink="false">tag:honmaple.me,2018-02-23:/articles/2018/02/docker笔记.html</guid><category>linux</category><category>docker</category></item></channel></rss>