<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>HonMaple's Blog</title><link>http://honmaple.org/</link><description></description><lastBuildDate>Sat, 26 Dec 2015 00:00:00 +0800</lastBuildDate><item><title>如何备份postgresql数据库</title><link>http://honmaple.org/articles/2015/12/%E5%A6%82%E4%BD%95%E5%A4%87%E4%BB%BDpostgresql%E6%95%B0%E6%8D%AE%E5%BA%93.html</link><description>&lt;p&gt;忽然想到一句经典台词  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;曾经&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;对于网站来说数据无疑是最重要的，而养成备份数据的习惯更加重要，
忽然想到一句经典台词  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;曾经有一份数据摆在我的面前，&lt;br /&gt;
可我没有备份，&lt;br /&gt;
直到数据丢失后才后悔莫及,&lt;br /&gt;
人世间最痛苦的事莫过于此，&lt;br /&gt;
如果上天能给我一次再来一次的机会，&lt;br /&gt;
我会对那份数据说五个字：我要备份你，&lt;br /&gt;
如果非要在这份备份上加一个期限，我希望是每天！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;进入主题,这只是对数据进行简单的备份&lt;/p&gt;
&lt;h3&gt;怎么备份数据&lt;/h3&gt;
&lt;p&gt;shell脚本&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;backup_time&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;date +%Y%m%d&lt;span class="sb"&gt;`&lt;/span&gt;
pg_dump articledb &amp;gt; /home/xxx/backup/article_&lt;span class="nv"&gt;$backup_time&lt;/span&gt;.sql
&lt;span class="c1"&gt;# articledb是要备份的数据库名称&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;backup finished&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;保存为backup_db.sh&lt;br /&gt;
&lt;strong&gt;注意&lt;/strong&gt;&lt;br /&gt;
xxx是数据库用户,并且是super权限&lt;br /&gt;
可以这样  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo -i -u postgres
$ &lt;span class="o"&gt;[&lt;/span&gt;sudo&lt;span class="o"&gt;]&lt;/span&gt; xxx 的密码:
postgres~ $ createuser xxx --interactive 
&lt;span class="c1"&gt;# 创建数据库用户,我的是archlinux,不同系统可能有所不同&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;定时备份数据&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;crontab -e
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;输入  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;0 22 * * * /home/xxx/backup/backup_db.sh
#表示每天22点定时备份数据
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如果你需要在其他时间段备份数据，请查阅crontab文档&lt;/p&gt;
&lt;p&gt;ok，就这样&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">2015-12-26 08:26:26.877510</dc:creator><pubDate>Sat, 26 Dec 2015 00:00:00 +0800</pubDate><guid isPermaLink="false">tag:honmaple.org,2015-12-26:articles/2015/12/如何备份postgresql数据库.html</guid><category>postgresql</category><category>sql</category><category>linux</category></item></channel></rss>