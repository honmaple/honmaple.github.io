<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>HonMaple's Blog</title><link>http://honmaple.org/</link><description></description><lastBuildDate>Tue, 02 Feb 2016 00:00:00 +0800</lastBuildDate><item><title>flask使用ajax</title><link>http://honmaple.org/articles/2016/02/flask%E4%BD%BF%E7%94%A8ajax.html</link><description>&lt;p&gt;[参考文档](http://www.w3school.com.cn/jq&lt;/p&gt;
&lt;h3&gt;简单使用ajax&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://www.w3school.com.cn/jquery/jquery_ref_ajax.asp"&gt;参考文档&lt;/a&gt;  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;text/javascript&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
$(document).ready(function(){
    $(&amp;#39;button#ajax&amp;#39;).click(function() {
        $.ajax ({
            type : &amp;quot;POST&amp;quot;,
            url : &amp;quot;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;url_for&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;index.login&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&amp;quot;,
            data:JSON.stringify({
                name: $(&amp;#39;input[name=&amp;quot;name&amp;quot;]&amp;#39;).val(),
                passwd: $(&amp;#39;input[name=&amp;quot;passwd&amp;quot;]&amp;#39;).val()
            }),
            contentType: &amp;#39;application/json;charset=UTF-8&amp;#39;,
            success: function(result) {
                if (result.judge == true)
                {
                    window.location = &amp;#39;/&amp;#39;;
                }
                else 
                {
                    $(&amp;quot;#showerror&amp;quot;).show();
                    $(&amp;quot;#error&amp;quot;).text(result.error);
                }
            }
        });
    });
});
&lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ajax使用CSRF&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://flask-wtf.readthedocs.org/en/latest/csrf.html"&gt;参考文档&lt;/a&gt;  &lt;/p&gt;
&lt;h4&gt;首先注册CSRF&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask_wtf.csrf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;CsrfProtect&lt;/span&gt;
&lt;span class="n"&gt;csrf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CsrfProtect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;csrf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init_app&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;在模板中使用&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;var csrftoken = &amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;csrf_token&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="x"&gt;    $.ajaxSetup({&lt;/span&gt;
&lt;span class="x"&gt;        beforeSend: function(xhr, settings) {&lt;/span&gt;
&lt;span class="x"&gt;            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) &amp;amp;&amp;amp; !this.crossDomain) {&lt;/span&gt;
&lt;span class="x"&gt;                xhr.setRequestHeader(&amp;quot;X-CSRFToken&amp;quot;, csrftoken)&lt;/span&gt;
&lt;span class="x"&gt;            }&lt;/span&gt;
&lt;span class="x"&gt;        }&lt;/span&gt;
&lt;span class="x"&gt;    });&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">2016-02-02 16:57:01.607024</dc:creator><pubDate>Tue, 02 Feb 2016 00:00:00 +0800</pubDate><guid isPermaLink="false">tag:honmaple.org,2016-02-02:articles/2016/02/flask使用ajax.html</guid><category>flask</category><category>ajax</category><category>jquery</category></item></channel></rss>