<!DOCTYPE html>
<html lang="en">
<head>
        <title>HonMaple's Blog - python flask 分页</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../../theme/css/main.css" type="text/css" />
        <link rel="stylesheet" href="../../theme/css/pygments/monokai.css" type="text/css" />
   

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../../css/ie.css"/>
                <script src="../../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
<a href="http://github.com/honmaple/honmaple.github.io">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="../..">HonMaple's Blog </a></h1>
                <nav><ul>
                <li> <a href="../..">主页</a></li>
                    <li ><a href="../../category/blog-category.html">blog-category</a></li>
                    <li ><a href="../../category/linux.html">Linux</a></li>
                    <li ><a href="../../category/python.html">Python</a></li>
                    <li ><a href="../../category/sheng-huo-sui-bi.html">生活随笔</a></li>
                <li> <a href="../../archives/">Archives</a></li>
                    <li><a href="../../pages/about">About</a></li>
                </ul></nav>
        </header><!-- /#banner -->
        
        

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../../articles/2016/04/flask实现分页.html">flask实现分页</a></h1> 
<footer class="post-info">
        <abbr class="published" title="2016-04-14T00:00:00+02:00">
                四 14 四月 2016
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="../../author/honmaple.html">honmaple</a>
        </address>
<p>In <a href="../../category/python.html">Python</a>. </p>
<p>tags: <a href="../../tag/python-flask-fen-ye/">python flask 分页</a></p></footer><!-- /.post-info --><div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 数据库实现分页</a>
<ul>
<li><a href="#sec-1-1">1.1. offset</a></li>
<li><a href="#sec-1-2">1.2. limit</a></li>
</ul>
</li>
<li><a href="#sec-2">2. 前端实现分页</a>
<ul>
<li><a href="#sec-2-1">2.1. 需求设计</a></li>
<li><a href="#sec-2-2">2.2. 简单的上一页，下一页</a>
<ul>
<li><a href="#sec-2-2-1">2.2.1. 下一页,上一页</a></li>
<li><a href="#sec-2-2-2">2.2.2. 首页没有上一页，尾页没有下一页</a></li>
</ul>
</li>
<li><a href="#sec-2-3">2.3. 显示各个页码的分页</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 数据库实现分页</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> offset</h3>
<div class="outline-text-3" id="text-1-1">
<p>
使用offset可以实现数据库分页功能
</p>
<div class="org-src-container">

<pre class="src src-python">questions = Questions.query.offset(num) # 从num开始
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> limit</h3>
<div class="outline-text-3" id="text-1-2">
<p>
使用limit实现限制每页的文章数量
</p>
<div class="org-src-container">

<pre class="src src-python">questions = Questions.query.offset(num).limit(6) #每页显示6篇文章
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 前端实现分页</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> 需求设计</h3>
<div class="outline-text-3" id="text-2-1">
<p>
是使用上一页，下一页，用表单进行跳转,还是使用数字显示
</p>

<p>
获得文章数量 <b>pages</b>,和当前页码 <b>number</b>
</p>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> 简单的上一页，下一页</h3>
<div class="outline-text-3" id="text-2-2">
<p>
<i>因为我的设计不是这个，所以简单说一下</i>
</p>
</div>

<div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1"><span class="section-number-4">2.2.1</span> 下一页,上一页</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
<b>jinja2</b> 代码
</p>
<div class="org-src-container">

<pre class="src src-html">&lt;a href="{{ url_for('blog.index',number=number + 1)}}"&gt;下一页&lt;/a&gt;
&lt;a href="{{ url_for('blog.index',number=number - 1)}}"&gt;下一页&lt;/a&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-2-2" class="outline-4">
<h4 id="sec-2-2-2"><span class="section-number-4">2.2.2</span> 首页没有上一页，尾页没有下一页</h4>
<div class="outline-text-4" id="text-2-2-2">
<div class="org-src-container">

<pre class="src src-html">{% if number == pages %}
no next page
{% else %}
 &lt;a href="{{ url_for('blog.index',number=number + 1)}}"&gt;下一页&lt;/a&gt;
{% endif %}
{% if number == 1 %}
no previous page
{% else %}
 &lt;a href="{{ url_for('blog.index',number=number - 1)}}"&gt;上一页&lt;/a&gt;
{% endif %}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> 显示各个页码的分页</h3>
<div class="outline-text-3" id="text-2-3">
<p>
搞了一下午,终于搞定了
</p>
<div class="org-src-container">

<pre class="src src-html">{% macro page(url,number=1,pages=1,kw=None) -%}
&lt;div style="text-align:center;margin-top:-15px"&gt;
    &lt;ul class="pagination"&gt;
	{%- if number == 1 %}
	&lt;li class="disabled"&gt;
	    &lt;a aria-label="Previous"&gt;
		&lt;span aria-hidden="true"&gt;&amp;laquo;&lt;/span&gt;
	    &lt;/a&gt;
	&lt;/li&gt;
	{%- else -%}
	&lt;li&gt;
	    {% if not kw %}
	    &lt;a href="{{ url_for(url,number=number-1) }}" aria-label="Previous"&gt;
		&lt;span aria-hidden="true"&gt;&amp;laquo;&lt;/span&gt;
	    &lt;/a&gt;
	    {% else %}
	    &lt;a href="{{ url_for(url,number=number-1,**kw) }}" aria-label="Previous"&gt;
		&lt;span aria-hidden="true"&gt;&amp;laquo;&lt;/span&gt;
	    &lt;/a&gt;
	    {% endif -%}
	&lt;/li&gt;
	{% endif -%}

	{% if pages &lt; 7 %}
	{% for page in range(1,pages + 1) %}
	{{ page_url(url,page,number,kw) }}
	{% endfor %}
	{% else %}
	{% if number &lt;= 4 %}
	{% for page in range(1,6) %}
	{{ page_url(url,page,number,kw) }}
	{% endfor %}

	{%- if number &lt;= pages - 2 %}
	&lt;li class="disabled"&gt;&lt;a&gt;···&lt;/a&gt;&lt;/li&gt;
	{%- endif -%}

	{{ page_url(url,pages,number,kw) }}
	{% else %}
	{{ page_url(url,1,number,kw) }}
	{{ page_url(url,2,number,kw) }}
	{{ page_dot_start(number)}}

	{% if number &gt;= pages - 3 %}
	{% for page in range(number-2,pages + 1) %}
	{{ page_url(url,page,number,kw) }}
	{% endfor %}
	{% else %}
	{% for page in range(number-2,number + 3) %}
	{{ page_url(url,page,number,kw) }}
	{% endfor %}
	{{ page_dot_end(pages,number) }}
	{{ page_url(url,pages,number,kw) }}
	{% endif  %}

	{% endif  %}
	{% endif  %}


	{%- if number == pages %}
	&lt;li class="disabled"&gt;
	    &lt;a aria-label="Next"&gt;
		&lt;span aria-hidden="true"&gt;&amp;raquo;&lt;/span&gt;
	    &lt;/a&gt;
	&lt;/li&gt;
	{%- else -%}
	&lt;li&gt;
	    {% if not kw %}
	    &lt;a href="{{ url_for(url,number=number+1) }}" aria-label="Next"&gt;
		&lt;span aria-hidden="true"&gt;&amp;raquo;&lt;/span&gt;
	    &lt;/a&gt;
	    {% else %}
	    &lt;a href="{{ url_for(url,number=number+1,**kw) }}" aria-label="Next"&gt;
		&lt;span aria-hidden="true"&gt;&amp;raquo;&lt;/span&gt;
	    &lt;/a&gt;
	    {% endif -%}
	&lt;/li&gt;
	{% endif -%}
    &lt;/ul&gt;
&lt;/div&gt;
{% endmacro %}

{% macro page_url(url,page,number,kw) -%}
{%- if page == number %}
&lt;li class="active"&gt;{{ page_kw(url,page,kw)}}&lt;/li&gt;
{%- else -%}
&lt;li&gt;{{ page_kw(url,page,kw)}}&lt;/li&gt;
{%- endif -%}
{% endmacro %}

{% macro page_dot_end(pages,number) -%}
{%- if number &lt;= pages - 4 %}
&lt;li class="disabled"&gt;&lt;a&gt;···&lt;/a&gt;&lt;/li&gt;
{%- endif -%}
{% endmacro %}

{% macro page_dot_start(number) -%}
{%- if number &gt; 5 %}
&lt;li class="disabled"&gt;&lt;a&gt;···&lt;/a&gt;&lt;/li&gt;
{%- endif -%}
{% endmacro %}

{% macro page_kw(url,page,kw) -%}
{% if not kw %}
&lt;a href="{{ url_for(url,number=page) }}"&gt;{{ page }}&lt;/a&gt;
{% else %}
&lt;a href="{{ url_for(url,number=page,**kw) }}"&gt;{{ page }}&lt;/a&gt;
{%- endif -%}
{% endmacro %}
</pre>
</div>
</div>
</div>
</div>
<p>There are <a href="../../articles/2016/04/flask实现分页.html#disqus_thread">comments</a>.</p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="https://honmaple.com">个人博客</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            
                            <li><a href="https://github.com/honmaple">GitHub</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">

        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'honmaple';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>